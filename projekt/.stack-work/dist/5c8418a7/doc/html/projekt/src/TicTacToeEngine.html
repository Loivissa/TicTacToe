<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TicTacToeEngine</span><span> </span><span class="hs-special">(</span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#GameStatus"><span class="hs-identifier hs-type">GameStatus</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#newBoard"><span class="hs-identifier hs-var">newBoard</span></a><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#makeAMove"><span class="hs-identifier hs-var">makeAMove</span></a><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#seeGameStatus"><span class="hs-identifier hs-var">seeGameStatus</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-2"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Ix</span><span></span><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span></span><span>
</span><a name="line-4"></a><span></span><span>
</span><a name="line-5"></a><span class="hs-comment">--a!i - element with an index i from array a</span><span>
</span><a name="line-6"></a><span class="hs-comment">--a // [(i1,e1), (i2,e2)] - returns an copy of a except that a!i1 is replacd by e1 and a!i2 is replaced by e2</span><span>
</span><a name="line-7"></a><span class="hs-comment">--listArray (i1,i2) [e1,e2,e3...] - returns an array with indexes from i1 to i2 and elements e1,e2,e3 etc.</span><span>
</span><a name="line-8"></a><span class="hs-comment">--elems arr - returns a list of elements contained in arr</span><span>
</span><a name="line-9"></a><span class="hs-identifier">newBoard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-comment">--returns a new, empty board</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- | @makeAMove@ returns @Just Board@ after making a specified move or @Nothing@ if move is impossible. Move is specified by the current game represented by a @Board@, a @Field@ indicating whether we want to place a @Circle@ or a @Cross@ and @(Int,Int)@ index (i,j) with i representing a row number and j representing a column number. Example: @makeAMove board Circle (0,2)@ &quot;puts&quot; a @Circle@ in field in row 0, column 2, if possible, returns @Nothing@ if impossible. (See @Board@ for the layout of the board)</span><span>
</span><a name="line-11"></a><span class="hs-identifier">makeAMove</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TicTacToeEngine.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span></span><span>
</span><a name="line-12"></a><span class="hs-comment">-- | takes a @Board@, returns information about status (@GameStatus@): is it won by circles, by crosses, is it a stalemate or is it ongoing? (See @GameStatus@)</span><span>
</span><a name="line-13"></a><span class="hs-identifier">seeGameStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TicTacToeEngine.html#GameStatus"><span class="hs-identifier hs-type">GameStatus</span></a><span> </span><span>
</span><a name="line-14"></a><span></span><span>
</span><a name="line-15"></a><span class="hs-comment">-- | @Field@ describes a possible state of a field on the playing board (represented by @Board@). A @Field@ can be @Empty@, can have a @Cross@ or a @Circle@.</span><span>
</span><a name="line-16"></a><span class="hs-keyword">data</span><span> </span><a name="Field"><a href="TicTacToeEngine.html#Field"><span class="hs-identifier">Field</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Empty"><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier">Empty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Cross"><a href="TicTacToeEngine.html#Cross"><span class="hs-identifier">Cross</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Circle"><a href="TicTacToeEngine.html#Circle"><span class="hs-identifier">Circle</span></a></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-17"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="TicTacToeEngine.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-18"></a><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span></span><span>
</span><a name="line-19"></a><span> </span><a href="TicTacToeEngine.html#Cross"><span class="hs-identifier hs-var">Cross</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="TicTacToeEngine.html#Cross"><span class="hs-identifier hs-var">Cross</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span></span><span>
</span><a name="line-20"></a><span> </span><a href="TicTacToeEngine.html#Circle"><span class="hs-identifier hs-var">Circle</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="TicTacToeEngine.html#Circle"><span class="hs-identifier hs-var">Circle</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span></span><span>
</span><a name="line-21"></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span></span><span>
</span><a name="line-22"></a><span></span><span>
</span><a name="line-23"></a><span class="hs-comment">-- | @GameStatus@ is a variable describing the state of the game - did it end or not and what is a result? @InProgress@ indicates that the game hasn't ended yet. @CircleWon@, @CrossWon@ an @Stalemate@ indicate both the fact that the game has ended and the result.</span><span>
</span><a name="line-24"></a><span class="hs-keyword">data</span><span> </span><a name="GameStatus"><a href="TicTacToeEngine.html#GameStatus"><span class="hs-identifier">GameStatus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="InProgress"><a href="TicTacToeEngine.html#InProgress"><span class="hs-identifier">InProgress</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CrossWon"><a href="TicTacToeEngine.html#CrossWon"><span class="hs-identifier">CrossWon</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CircleWon"><a href="TicTacToeEngine.html#CircleWon"><span class="hs-identifier">CircleWon</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Stalemate"><a href="TicTacToeEngine.html#Stalemate"><span class="hs-identifier">Stalemate</span></a></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-25"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="TicTacToeEngine.html#GameStatus"><span class="hs-identifier hs-type">GameStatus</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-26"></a><span> </span><a href="TicTacToeEngine.html#InProgress"><span class="hs-identifier hs-var">InProgress</span></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="TicTacToeEngine.html#InProgress"><span class="hs-identifier hs-var">InProgress</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span></span><span>
</span><a name="line-27"></a><span> </span><a href="TicTacToeEngine.html#CrossWon"><span class="hs-identifier hs-var">CrossWon</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="TicTacToeEngine.html#CrossWon"><span class="hs-identifier hs-var">CrossWon</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span></span><span>
</span><a name="line-28"></a><span> </span><a href="TicTacToeEngine.html#CircleWon"><span class="hs-identifier hs-var">CircleWon</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="TicTacToeEngine.html#CircleWon"><span class="hs-identifier hs-var">CircleWon</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span></span><span>
</span><a name="line-29"></a><span> </span><a href="TicTacToeEngine.html#Stalemate"><span class="hs-identifier hs-var">Stalemate</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="TicTacToeEngine.html#Stalemate"><span class="hs-identifier hs-var">Stalemate</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span></span><span>
</span><a name="line-30"></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span></span><span>
</span><a name="line-31"></a><span></span><span>
</span><a name="line-32"></a><span class="hs-comment">-- | @Board@ represents the board for the Tic Tac Toe game. Starting board is represented by @newBoard@, which is an empty 3x3 Tic Tac Toe board. It's rows and columns are numbered from 0 to 2. Those numbers are used to specify where do you want to move. (See @makeAMove@ for the exact way to specify where do you want to place your mark)</span><span>
</span><a name="line-33"></a><span class="hs-keyword">type</span><span> </span><a name="Board"><a href="TicTacToeEngine.html#Board"><span class="hs-identifier">Board</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Array</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><a href="TicTacToeEngine.html#Field"><span class="hs-identifier hs-type">Field</span></a><span></span><span>
</span><a name="line-34"></a><span></span><span>
</span><a name="line-35"></a><a name="newBoard"><a href="TicTacToeEngine.html#newBoard"><span class="hs-identifier">newBoard</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">listArray</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">,</span><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-36"></a><span></span><span>
</span><a name="line-37"></a><a name="makeAMove"><a href="TicTacToeEngine.html#makeAMove"><span class="hs-identifier">makeAMove</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span></span><span>
</span><a name="line-38"></a><span class="hs-identifier">makeAMove</span><span> </span><a name="local-6989586621679026502"><a href="#local-6989586621679026502"><span class="hs-identifier">board</span></a></a><span> </span><a name="local-6989586621679026503"><a href="#local-6989586621679026503"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679026504"><a href="#local-6989586621679026504"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679026505"><a href="#local-6989586621679026505"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span class="hs-special">(</span><a href="#local-6989586621679026504"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">&gt;=</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679026505"><span class="hs-identifier hs-var">j</span></a><span class="hs-operator hs-var">&gt;=</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679026504"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">&lt;=</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679026505"><span class="hs-identifier hs-var">j</span></a><span class="hs-operator hs-var">&lt;=</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679026502"><span class="hs-identifier hs-var">board</span></a><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="#local-6989586621679026504"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679026505"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026502"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">//</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679026504"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679026505"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679026503"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span></span><span>
</span><a name="line-39"></a><span></span><span>
</span><a name="line-40"></a><a name="seeGameStatus"><a href="TicTacToeEngine.html#seeGameStatus"><span class="hs-identifier">seeGameStatus</span></a></a><span> </span><a name="local-6989586621679026506"><a href="#local-6989586621679026506"><span class="hs-identifier">board</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026509"><span class="hs-identifier hs-var">filledRow</span></a><span> </span><a href="TicTacToeEngine.html#Cross"><span class="hs-identifier hs-var">Cross</span></a><span> </span><a href="#local-6989586621679026506"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679026510"><span class="hs-identifier hs-var">filledColumn</span></a><span> </span><a href="TicTacToeEngine.html#Cross"><span class="hs-identifier hs-var">Cross</span></a><span> </span><a href="#local-6989586621679026506"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679026511"><span class="hs-identifier hs-var">filedDiagonal</span></a><span> </span><a href="TicTacToeEngine.html#Cross"><span class="hs-identifier hs-var">Cross</span></a><span> </span><a href="#local-6989586621679026506"><span class="hs-identifier hs-var">board</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="TicTacToeEngine.html#CrossWon"><span class="hs-identifier hs-var">CrossWon</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026509"><span class="hs-identifier hs-var">filledRow</span></a><span> </span><a href="TicTacToeEngine.html#Circle"><span class="hs-identifier hs-var">Circle</span></a><span> </span><a href="#local-6989586621679026506"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679026510"><span class="hs-identifier hs-var">filledColumn</span></a><span> </span><a href="TicTacToeEngine.html#Circle"><span class="hs-identifier hs-var">Circle</span></a><span> </span><a href="#local-6989586621679026506"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679026511"><span class="hs-identifier hs-var">filedDiagonal</span></a><span> </span><a href="TicTacToeEngine.html#Circle"><span class="hs-identifier hs-var">Circle</span></a><span> </span><a href="#local-6989586621679026506"><span class="hs-identifier hs-var">board</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="TicTacToeEngine.html#CircleWon"><span class="hs-identifier hs-var">CircleWon</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026512"><span class="hs-identifier hs-var">allFilled</span></a><span> </span><a href="#local-6989586621679026506"><span class="hs-identifier hs-var">board</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="TicTacToeEngine.html#Stalemate"><span class="hs-identifier hs-var">Stalemate</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="TicTacToeEngine.html#InProgress"><span class="hs-identifier hs-var">InProgress</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span></span><span>
</span><a name="line-41"></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-42"></a><span> </span><span class="hs-identifier">checkIfEquals</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TicTacToeEngine.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-43"></a><span> </span><a name="local-6989586621679026507"><a href="#local-6989586621679026507"><span class="hs-identifier">checkIfEquals</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span></span><span>
</span><a name="line-44"></a><span> </span><span class="hs-identifier">checkIfEquals</span><span> </span><a name="local-6989586621679026513"><a href="#local-6989586621679026513"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679026514"><a href="#local-6989586621679026514"><span class="hs-identifier">board</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679026515"><a href="#local-6989586621679026515"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679026516"><a href="#local-6989586621679026516"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679026517"><a href="#local-6989586621679026517"><span class="hs-identifier">tail</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026513"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026514"><span class="hs-identifier hs-var">board</span></a><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="#local-6989586621679026515"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679026516"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679026507"><span class="hs-identifier hs-var">checkIfEquals</span></a><span> </span><a href="#local-6989586621679026513"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679026514"><span class="hs-identifier hs-var">board</span></a><span> </span><a href="#local-6989586621679026517"><span class="hs-identifier hs-var">tail</span></a><span> </span><span>
</span><a name="line-45"></a><span> </span><span class="hs-identifier">checkIfAnyEqual</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TicTacToeEngine.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-46"></a><span> </span><a name="local-6989586621679026508"><a href="#local-6989586621679026508"><span class="hs-identifier">checkIfAnyEqual</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span></span><span>
</span><a name="line-47"></a><span> </span><span class="hs-identifier">checkIfAnyEqual</span><span> </span><a name="local-6989586621679026518"><a href="#local-6989586621679026518"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679026519"><a href="#local-6989586621679026519"><span class="hs-identifier">board</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679026520"><a href="#local-6989586621679026520"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679026521"><a href="#local-6989586621679026521"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679026522"><a href="#local-6989586621679026522"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679026523"><a href="#local-6989586621679026523"><span class="hs-identifier">tail</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026507"><span class="hs-identifier hs-var">checkIfEquals</span></a><span> </span><a href="#local-6989586621679026518"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679026519"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679026520"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679026521"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679026522"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679026508"><span class="hs-identifier hs-var">checkIfAnyEqual</span></a><span> </span><a href="#local-6989586621679026518"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679026519"><span class="hs-identifier hs-var">board</span></a><span> </span><a href="#local-6989586621679026523"><span class="hs-identifier hs-var">tail</span></a><span></span><span>
</span><a name="line-48"></a><span> </span><span class="hs-identifier">filledRow</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TicTacToeEngine.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-49"></a><span> </span><a name="local-6989586621679026509"><a href="#local-6989586621679026509"><span class="hs-identifier">filledRow</span></a></a><span> </span><a name="local-6989586621679026524"><a href="#local-6989586621679026524"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679026525"><a href="#local-6989586621679026525"><span class="hs-identifier">board</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679026508"><span class="hs-identifier hs-var">checkIfAnyEqual</span></a><span> </span><a href="#local-6989586621679026524"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679026525"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679026526"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679026527"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679026527"><a href="#local-6989586621679026527"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-number">2</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679026526"><a href="#local-6989586621679026526"><span class="hs-identifier">i</span></a></a><span class="hs-glyph">&lt;-</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-number">2</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span>
</span><a name="line-50"></a><span> </span><span class="hs-identifier">filledColumn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TicTacToeEngine.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-51"></a><span> </span><a name="local-6989586621679026510"><a href="#local-6989586621679026510"><span class="hs-identifier">filledColumn</span></a></a><span> </span><a name="local-6989586621679026528"><a href="#local-6989586621679026528"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679026529"><a href="#local-6989586621679026529"><span class="hs-identifier">board</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679026508"><span class="hs-identifier hs-var">checkIfAnyEqual</span></a><span> </span><a href="#local-6989586621679026528"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679026529"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679026531"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679026530"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679026531"><a href="#local-6989586621679026531"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-number">2</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679026530"><a href="#local-6989586621679026530"><span class="hs-identifier">j</span></a></a><span class="hs-glyph">&lt;-</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-number">2</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span>
</span><a name="line-52"></a><span> </span><span class="hs-identifier">filedDiagonal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TicTacToeEngine.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-53"></a><span> </span><a name="local-6989586621679026511"><a href="#local-6989586621679026511"><span class="hs-identifier">filedDiagonal</span></a></a><span> </span><a name="local-6989586621679026532"><a href="#local-6989586621679026532"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679026533"><a href="#local-6989586621679026533"><span class="hs-identifier">board</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679026508"><span class="hs-identifier hs-var">checkIfAnyEqual</span></a><span> </span><a href="#local-6989586621679026532"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679026533"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-54"></a><span> </span><span class="hs-identifier">allFilled</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TicTacToeEngine.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-55"></a><span> </span><a name="local-6989586621679026512"><a href="#local-6989586621679026512"><span class="hs-identifier">allFilled</span></a></a><span> </span><a name="local-6989586621679026534"><a href="#local-6989586621679026534"><span class="hs-identifier">board</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679026535"><span class="hs-identifier hs-var">allFilledOnList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">elems</span><span> </span><a href="#local-6989586621679026534"><span class="hs-identifier hs-var">board</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-identifier">allFilledOnList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TicTacToeEngine.html#Field"><span class="hs-identifier hs-type">Field</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-58"></a><span>  </span><a name="local-6989586621679026535"><a href="#local-6989586621679026535"><span class="hs-identifier">allFilledOnList</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span></span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-identifier">allFilledOnList</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679026536"><a href="#local-6989586621679026536"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679026537"><a href="#local-6989586621679026537"><span class="hs-identifier">at</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span class="hs-special">(</span><a href="#local-6989586621679026536"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">==</span><a href="TicTacToeEngine.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026535"><span class="hs-identifier hs-var">allFilledOnList</span></a><span> </span><a href="#local-6989586621679026537"><span class="hs-identifier hs-var">at</span></a><span class="hs-special">)</span></pre></body></html>